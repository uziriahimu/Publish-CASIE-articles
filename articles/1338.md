---
title: "<title>IIS 6.0 Vulnerability Leads to Code Execution - TrendLabs Security Intelligence Blog</title>"
id: 1338
---

<title>IIS 6.0 Vulnerability Leads to Code Execution - TrendLabs Security Intelligence Blog</title>
<source> http://blog.trendmicro.com/trendlabs-security-intelligence/iis-6-0-vulnerability-leads-code-execution/ </source>
<date> 2017_03_29 </date>
<text>
Microsoft Internet Information Services (IIS) 6.0 is vulnerable to a zero-day Buffer Overflow vulnerability (CVE-2017-7269) due to an improper validation of an ‘IF’ header in a PROPFIND request.
A remote attacker could exploit this vulnerability in the IIS WebDAV Component with a crafted request using PROPFIND  method.
Successful exploitation could result in denial of service condition or  arbitrary code execution in the context of the user running the application.
According to the researchers who found this flaw, this vulnerability was exploited in the wild in July or August 2016.
Other threat actors are now in the stages of creating malicious code based on the original proof-of-concept (PoC) code.
Web Distributed Authoring and Versioning (WebDAV) is an extension of the HTTP protocol that allows clients to perform remote Web content authoring operations.
WebDAV extends the set of standard HTTP methods and headers allowed for the HTTP request.
Few example of WebDAV methods are COPY, LOCK, MKCOL, PROPFIND, UNLOCK etc.
This vulnerability is exploited using the PROPFIND method and IF header.
The PROPFIND method retrieves properties defined on the resource identified by the Request-URI.
All the WebDAV-Compliant resources must support the PROPFIND method.
The IF header handles the state token as well as the ETags.
It makes the request conditional by supplying a series of state lists with conditions that match tokens and ETags to specific resource.
If all states present in the IF header fail, the request fails with 412 (Precondition Failed) status.
</text>



## Annotations

Annotation keys: content, sourcefile, cyberevent, info

<details>
<summary>Raw annotation JSON (preview)</summary>

```json
{
  "content": "Microsoft Internet Information Services (IIS) 6.0 is vulnerable to a zero-day Buffer Overflow vulnerability (CVE-2017-7269) due to an improper validation of an \u2018IF\u2019 header in a PROPFIND request. A remote attacker could exploit this vulnerability in the IIS WebDAV Component with a crafted request using PROPFIND \u00a0method. Successful exploitation could result in denial of service condition or \u00a0arbitrary code execution in the context of the user running the application. According to the researchers who found this flaw, this vulnerability was exploited in the wild in July or August 2016. Other threat actors are now in the stages of creating malicious code based on the original proof-of-concept (PoC) code. Web Distributed Authoring and Versioning (WebDAV) is an extension of the HTTP protocol that allows clients to perform remote Web content authoring operations. WebDAV extends the set of standard HTTP methods and headers allowed for the HTTP request. Few example of WebDAV methods are COPY, LOCK, MKCOL, PROPFIND, UNLOCK etc. This vulnerability is exploited using the PROPFIND method and IF header. The PROPFIND method retrieves properties defined on the resource identified by the Request-URI. All the WebDAV-Compliant resources must support the PROPFIND method. The IF header handles the state token as well as the ETags. It makes the request conditional by supplying a series of state lists with conditions that match tokens and ETags to specific resource. If all states present in the IF header fail, the request fails with 412 (Precondition Failed) status",
  "sourcefile": "1338.txt",
  "cyberevent": {
    "hopper": [
      {
        "index": 0,
        "relation": "Same",
        "events": [
          {
            "index": "E3",
            "type": "Vulnerability-related",
            "realis": "Actual",
            "nugget": {
              "startOffset": 539,
              "index": "T12",
              "endOffset": 552,
              "text": "was exploited"
            },
            "argument": [
              {
                "index": "T8",
                "text": "this vulnerability",
                "endOffset": 538,
                "role": {
                  "type": "Vulnerability"
                },
                "startOffset": 520,
                "type": "Vulnerability"
              },
              {
                "index": "T9",
                "text": "July",
                "endOffset": 572,
                "role": {
                  "type": "Time"
                },
                "startOffset": 568,
                "type": "Time"
              },
              {
                "index": "T10",
                "text": "August 2016",
                "endOffset": 587,
                "role": {
                  "type": "Time"
                },
                "startOffset": 576,
                "type": "Time"
              },
              {
                "index": "T16",
                "text": "creating malicious code based on the original proof-of-concept (PoC) code",
                "endOffset": 707,
                "role": {
                  "CAPEC-Meta": "Code Injection",
                  "type": "Capabilities",
                  "confidence": 0.9466875791549683
                },
                "startOffset": 634,
                "type": "Capabilities"
              }
            ],
            "subtype": "DiscoverVulnerability"
          },
          {
            "index": "E2",
            "type": "Vulnerability-related",
            "realis": "Actual",
            "nugget": {
              "startOffset": 503,
              "index": "T6",
              "endOffset": 508,
              "text": "found"
            },
            "argument": [
              {
                "index": "T7",
                "text": "this flaw",
                "endOffset": 518,
                "role": {
                  "type": "Vulnerability"
                },
                "startOffset
```
</details>
