---
title: "<title> Microsoft’s Windows 7 Meltdown patch created ‘worse’ flaw </title>"
id: 10199
---

<title> Microsoft’s Windows 7 Meltdown patch created ‘worse’ flaw </title>
<source> https://nakedsecurity.sophos.com/2018/03/29/microsofts-windows-7-meltdown-patch-created-worse-flaw/ </source>
<date> 2018_03_29 </date>
<text>
Microsoft’s updates for the Meltdown microprocessor mega-flaw inadvertently left users running Windows 7 64-bit systems open to a “way worse” flaw, a researcher has claimed.
To recap, Meltdown (aka F**CKWIT or CVE-2017-5754) is a proof-of-concept hardware vulnerability uncovered almost simultaneously by several groups of researchers through which an attacker could access the contents of kernel memory (passwords, encryption keys, say) from the part used by ordinary applications.
An extremely inviting target for any attacker, which is why Microsoft sprang into action to mitigate the vulnerability (in addition to BIOS updates from vendors) across different Windows versions in two rounds of updates in January and February.
But according to Ulf Frisk, something went awry starting with the January update when applied to Windows 7 and Windows Server 2008 R2, which miss-set controlling permissions for something called the Page Map Level 4 (PML4).
This is a table used by Intel microprocessors to “translate the virtual addresses of a process into physical memory addresses in RAM.”
Set correctly, only the kernel should be able to access this table. The result of the issue is that an attacker aware of the flaw would have the ability to break out of the application space and take over a system.
All this from a simple software mistake:
    No fancy exploits were needed. Windows 7 already did the hard work of mapping in the required memory into every running process. Exploitation was just a matter of read and write to already mapped in-process virtual memory. No fancy APIs or syscalls required – just standard read and write!
</text>



## Annotations

Annotation keys: content, sourcefile, cyberevent, info

<details>
<summary>Raw annotation JSON (preview)</summary>

```json
{
  "content": "Microsoft\u2019s updates for the Meltdown microprocessor mega-flaw inadvertently left users running Windows 7 64-bit systems open to a \u201cway worse\u201d flaw, a researcher has claimed. To recap, Meltdown (aka F**CKWIT or CVE-2017-5754) is a proof-of-concept hardware vulnerability uncovered almost simultaneously by several groups of researchers through which an attacker could access the contents of kernel memory (passwords, encryption keys, say) from the part used by ordinary applications. An extremely inviting target for any attacker, which is why Microsoft sprang into action to mitigate the vulnerability (in addition to BIOS updates from vendors) across different Windows versions in two rounds of updates in January and February. But according to Ulf Frisk, something went awry starting with the January update when applied to Windows 7 and Windows Server 2008 R2, which miss-set controlling permissions for something called the Page Map Level 4 (PML4). This is a table used by Intel microprocessors to \u201ctranslate the virtual addresses of a process into physical memory addresses in RAM.\u201d Set correctly, only the kernel should be able to access this table. The result of the issue is that an attacker aware of the flaw would have the ability to break out of the application space and take over a system. All this from a simple software mistake:     No fancy exploits were needed. Windows 7 already did the hard work of mapping in the required memory into every running process. Exploitation was just a matter of read and write to already mapped in-process virtual memory. No fancy APIs or syscalls required \u2013 just standard read and write!",
  "sourcefile": "10199.txt",
  "cyberevent": {
    "hopper": [
      {
        "index": 0,
        "relation": "Same",
        "events": [
          {
            "index": "E3",
            "type": "Vulnerability-related",
            "realis": "Actual",
            "nugget": {
              "startOffset": 575,
              "index": "T12",
              "endOffset": 583,
              "text": "mitigate"
            },
            "argument": [
              {
                "index": "T13",
                "text": "vendors",
                "endOffset": 643,
                "role": {
                  "type": "Releaser"
                },
                "startOffset": 636,
                "type": "Organization"
              },
              {
                "index": "T14",
                "text": "the vulnerability",
                "endOffset": 601,
                "role": {
                  "type": "Vulnerability"
                },
                "startOffset": 584,
                "type": "Vulnerability"
              },
              {
                "index": "T19",
                "external_reference": {
                  "wikidataid": "Q2283"
                },
                "endOffset": 552,
                "role": {
                  "type": "Releaser"
                },
                "text": "Microsoft",
                "startOffset": 543,
                "type": "Organization"
              },
              {
                "index": "T20",
                "text": "BIOS updates",
                "endOffset": 630,
                "role": {
                  "type": "Patch"
                },
                "startOffset": 618,
                "type": "Patch"
              }
            ],
            "subtype": "PatchVulnerability"
          },
          {
            "index": "E4",
            "type": "Vulnerability-related",
            "realis": "Actual",
            "nugget": {
              "startOffset": 696,
              "index": "T16",
              "endOffset": 703,
              "text": "updates"
            },
            "argument": [
              {
                "index": "T17",
                "text": "January",
                "endOffset": 714,
                "role": {
                  "type": "Time"
                },
              
```
</details>
