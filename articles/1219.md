---
title: "<title>Critical Moodle Vulnerability Could Lead to Server Compromise | Threatpost | The first stop for security news</title>"
id: 1219
---

<title>Critical Moodle Vulnerability Could Lead to Server Compromise | Threatpost | The first stop for security news</title>
<source> https://threatpost.com/critical-moodle-vulnerability-could-lead-to-server-compromise/124446/ </source>
<date> 2017_03_22 </date>
<text>
A critical vulnerability in Moodle, an open source PHP-based learning management system deployed across scores of schools and universities, could expose the server its running on to compromise.
Tens of thousands of universities worldwide, including the California State University system, the University of Oxford, and Stanford University, use the service to provide students with course outlines, grades, and other personal data.
The issue–at its root a SQL injection vulnerability–could be used by an attacker to execute PHP code on a university’s server according to Netanel Rubin, the researcher who found the bug.
Rubin, who has previously dug up vulnerabilities in Mozilla’s Bugzilla bug tracking system, e-commerce platform Magento, and WordPress, described the bug in depth in a blog post on Monday.
“Similar scenarios could be used in previous versions of Moodle but only by managers/admins and only via web services,” the advisory reads.
School IT administrators are being encouraged to apply a patch that maintainers of the system pushed 10 days ago.
Rubin discovered that he could exploit the feature however and get an unserialize call by leaving a preference in a block mechanism empty.
That could open the door to an object injection attack.
While the attack had its limitations, Rubin discovered a way to pivot from it to a series of method calls.
From there, he found he could use the system’s “update” method to update any row in an affected database.
This gave him the ability to tweak administrator accounts, passwords, the site configuration, “basically whatever we want,” he wrote.
Rubin used a double SQL injection to top off his exploit, helping him gain full administrator privileges on any server running Moodle.
“After gaining full administrator privileges executing code is as simple as uploading a new plugin or template to the server,” Rubin writes.
</text>



## Annotations

Annotation keys: content, sourcefile, cyberevent, info

<details>
<summary>Raw annotation JSON (preview)</summary>

```json
{
  "content": "A critical vulnerability in Moodle, an open source PHP-based learning management system deployed across scores of schools and universities, could expose\u00a0the server its running on to compromise. Tens of thousands of universities worldwide, including the California State University system, the University of Oxford, and Stanford University, use the service to provide students with course outlines, grades, and other personal data. The issue\u2013at its root a SQL injection vulnerability\u2013could be used by an attacker to execute PHP code on a university\u2019s server according to Netanel Rubin, the researcher who found the bug. Rubin, who has previously dug up vulnerabilities in Mozilla\u2019s Bugzilla bug tracking system, e-commerce platform Magento, and WordPress, described the bug\u00a0in depth in a blog post on Monday. \u201cSimilar scenarios could be used in previous versions of Moodle but only by managers/admins and only via web services,\u201d the advisory reads. School IT administrators are being encouraged to apply a patch that maintainers of the system pushed 10 days ago. Rubin discovered that he could exploit the feature\u00a0however and get an unserialize call by leaving a preference in a block mechanism empty. That could open the door to an object injection attack. While the attack had its limitations, Rubin discovered a way to pivot from it to a series of method calls. From there, he found he could use the system\u2019s \u201cupdate\u201d method to update any row in an affected database. This gave him the ability to tweak administrator accounts, passwords, the site configuration, \u201cbasically whatever we want,\u201d he wrote. Rubin used a double SQL injection to top off his exploit, helping him gain full administrator privileges on any server running Moodle. \u201cAfter gaining full administrator privileges executing code is as simple as uploading a new plugin or template to the server,\u201d Rubin writes.",
  "sourcefile": "1219.txt",
  "cyberevent": {
    "hopper": [
      {
        "index": 0,
        "relation": "Same",
        "events": [
          {
            "index": "E1",
            "type": "Vulnerability-related",
            "realis": "Actual",
            "nugget": {
              "startOffset": 604,
              "index": "T5",
              "endOffset": 609,
              "text": "found"
            },
            "argument": [
              {
                "index": "T6",
                "text": "the bug",
                "endOffset": 617,
                "role": {
                  "type": "Vulnerability"
                },
                "startOffset": 610,
                "type": "Vulnerability"
              },
              {
                "index": "T7",
                "text": "the researcher",
                "endOffset": 599,
                "role": {
                  "type": "Discoverer"
                },
                "startOffset": 585,
                "type": "Person"
              },
              {
                "index": "T4",
                "text": "Netanel Rubin",
                "endOffset": 583,
                "role": {
                  "type": "Discoverer"
                },
                "startOffset": 570,
                "type": "Person"
              },
              {
                "index": "T2",
                "text": "SQL injection vulnerability",
                "endOffset": 482,
                "role": {
                  "type": "Vulnerability"
                },
                "startOffset": 455,
                "type": "Vulnerability"
              },
              {
                "index": "T3",
                "text": "execute PHP code",
                "endOffset": 531,
                "role": {
                  "CAPEC-Meta": "Code Inclusion",
                  "type": "Capabilities",
                  "confidence": 0.942440003156662
                },
                "startOffset": 515,
                "type": "Capabili
```
</details>
